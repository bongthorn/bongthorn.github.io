(window.webpackJsonp=window.webpackJsonp||[]).push([[66],{121:function(t,e,n){"use strict";n.r(e),n.d(e,"frontMatter",(function(){return o})),n.d(e,"metadata",(function(){return s})),n.d(e,"rightToc",(function(){return i})),n.d(e,"default",(function(){return p}));var r=n(2),a=(n(0),n(211));const o={title:"Step11 PostsEdit"},s={unversionedId:"crud2a-react-react-router/11-posts-edit",id:"crud2a-react-react-router/11-posts-edit",isDocsHomePage:!1,title:"Step11 PostsEdit",description:"PostsEditPage is a combination of PostsShowPage and PostsNewPage.",source:"@site/docs/crud2a-react-react-router/11-posts-edit.md",permalink:"/docs/crud2a-react-react-router/11-posts-edit",editUrl:"https://github.com/facebook/docusaurus/edit/master/website/docs/crud2a-react-react-router/11-posts-edit.md",sidebar:"crud2aReactReactRouter",previous:{title:"Step10 My Posts Page and Delete Post",permalink:"/docs/crud2a-react-react-router/10-my-posts-and-delete-post"},next:{title:"Step12 Client Side Authorization",permalink:"/docs/crud2a-react-react-router/12-client-size-authorization"}},i=[],c={rightToc:i};function p({components:t,...e}){return Object(a.a)("wrapper",Object(r.a)({},c,e,{components:t,mdxType:"MDXLayout"}),Object(a.a)("p",null,Object(a.a)("strong",{parentName:"p"},"PostsEditPage")," is a combination of ",Object(a.a)("strong",{parentName:"p"},"PostsShowPage")," and ",Object(a.a)("strong",{parentName:"p"},"PostsNewPage"),"."),Object(a.a)("ol",null,Object(a.a)("li",{parentName:"ol"},"Fetch post by using ",Object(a.a)("inlineCode",{parentName:"li"},":id")," and set initial form value"),Object(a.a)("li",{parentName:"ol"},"Send PUT request for updating post")),Object(a.a)("p",null,Object(a.a)("inlineCode",{parentName:"p"},"src/pages/PostsEditPage.js"),":"),Object(a.a)("pre",null,Object(a.a)("code",Object(r.a)({parentName:"pre"},{className:"language-js"}),'import React from "react";\nimport axios from \'axios\';\nimport { withRouter } from "react-router-dom";\n\nimport { getAccessToken } from "../utils/auth";\n\nclass PostsEditPage extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      post: null,\n      title: "",\n      content: "",\n      isSubmitting: false,\n      isLoaded: false\n    };\n  }\n\n  componentDidMount() {\n    // https://reacttraining.com/react-router/web/api/Route/component\n    // https://stackoverflow.com/questions/35352638/react-how-to-get-parameter-value-from-query-string\n    const { id } = this.props.match.params\n\n    axios.get(`http://localhost:3000/posts/${id}`)\n      .then((res) => {\n        const post = res.data;\n        const { title, content } = post;\n        this.setState({\n          isLoaded: true,\n          post,\n          title,\n          content\n        });\n      })\n      .catch((error) => {\n        this.setState({\n          isLoaded: true,\n          error\n        });\n      })\n  }\n\n  handleInputChange = (event) => {\n    const target = event.target;\n    const value = target.value;\n    const name = target.name;\n\n    this.setState({\n      [name]: value\n    });\n  }\n\n  handleSubmit = (event) => {\n    event.preventDefault();\n\n    this.setState({\n      isSubmitting: true\n    })\n\n    const { id } = this.props.match.params\n    const { title, content } = this.state;\n\n\n    axios.put(`http://localhost:3000/posts/${id}/`, {\n      title,\n      content\n    }, {\n      headers: {\n        \'Authorization\': `Bearer ${getAccessToken()}`\n      },\n    })\n      .then((res) => {\n        const post = res.data;\n        this.props.history.push(`/posts/${post.id}`);\n      })\n      .catch((error) => {\n        this.setState({\n          isSubmitting: false,\n          error\n        });\n      })\n  }\n\n  render(){\n    const { title, content, error, isSubmitting, isLoaded } = this.state;\n\n    if (!isLoaded) {\n      return <div>Loading...</div>\n    } else {\n      return(\n        <>\n          <h1>Posts#Edit</h1>\n          <div>{error && error.message}</div>\n          <form onSubmit={this.handleSubmit}>\n          <label>\n            Title:\n            <input name="title" type="text" value={title} onChange={this.handleInputChange} />\n          </label>\n          <br/>\n          <label>\n            Content:\n            <input name="content" type="text" value={content} onChange={this.handleInputChange} />\n          </label>\n          <br/>\n          <input type="submit" value="Submit" disabled={isSubmitting} />\n        </form>\n        </>\n      )\n    }    \n  }\n}\n\nexport default withRouter(PostsEditPage);\n')))}p.isMDXComponent=!0},211:function(t,e,n){"use strict";n.d(e,"a",(function(){return m}));var r=n(0),a=n.n(r);function o(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function s(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function i(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?s(Object(n),!0).forEach((function(e){o(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function c(t,e){if(null==t)return{};var n,r,a=function(t,e){if(null==t)return{};var n,r,a={},o=Object.keys(t);for(r=0;r<o.length;r++)n=o[r],e.indexOf(n)>=0||(a[n]=t[n]);return a}(t,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(r=0;r<o.length;r++)n=o[r],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(a[n]=t[n])}return a}var p=a.a.createContext({}),u=function(t){var e=a.a.useContext(p),n=e;return t&&(n="function"==typeof t?t(e):i(i({},e),t)),n},l={inlineCode:"code",wrapper:function(t){var e=t.children;return a.a.createElement(a.a.Fragment,{},e)}},d=a.a.forwardRef((function(t,e){var n=t.components,r=t.mdxType,o=t.originalType,s=t.parentName,p=c(t,["components","mdxType","originalType","parentName"]),d=u(n),m=r,f=d["".concat(s,".").concat(m)]||d[m]||l[m]||o;return n?a.a.createElement(f,i(i({ref:e},p),{},{components:n})):a.a.createElement(f,i({ref:e},p))}));function m(t,e){var n=arguments,r=e&&e.mdxType;if("string"==typeof t||r){var o=n.length,s=new Array(o);s[0]=d;var i={};for(var c in e)hasOwnProperty.call(e,c)&&(i[c]=e[c]);i.originalType=t,i.mdxType="string"==typeof t?t:r,s[1]=i;for(var p=2;p<o;p++)s[p]=n[p];return a.a.createElement.apply(null,s)}return a.a.createElement.apply(null,n)}d.displayName="MDXCreateElement"}}]);