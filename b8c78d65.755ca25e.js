(window.webpackJsonp=window.webpackJsonp||[]).push([[107],{161:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return o})),n.d(t,"metadata",(function(){return s})),n.d(t,"rightToc",(function(){return i})),n.d(t,"default",(function(){return u}));var r=n(2),a=(n(0),n(211));const o={title:"Step20 My Posts Page"},s={unversionedId:"flutter-crud2a/my-posts-page",id:"flutter-crud2a/my-posts-page",isDocsHomePage:!1,title:"Step20 My Posts Page",description:"Edit MyPostsPage",source:"@site/docs/flutter-crud2a/my-posts-page.md",permalink:"/docs/flutter-crud2a/my-posts-page",editUrl:"https://github.com/facebook/docusaurus/edit/master/website/docs/flutter-crud2a/my-posts-page.md",sidebar:"flutterCrud2a",previous:{title:"Step19 Show Post Page",permalink:"/docs/flutter-crud2a/show-post-page"},next:{title:"Step21 Delete Post",permalink:"/docs/flutter-crud2a/delete-post"}},i=[{value:"Edit MyPostsPage",id:"edit-mypostspage",children:[]},{value:"Add <strong>PopupMenuButton</strong>",id:"add-popupmenubutton",children:[]}],p={rightToc:i};function u({components:e,...t}){return Object(a.b)("wrapper",Object(r.a)({},p,t,{components:e,mdxType:"MDXLayout"}),Object(a.b)("h2",{id:"edit-mypostspage"},"Edit MyPostsPage"),Object(a.b)("pre",null,Object(a.b)("code",Object(r.a)({parentName:"pre"},{className:"language-dart",metastring:'title="lib/pages/my_posts_page.dart"',title:'"lib/pages/my_posts_page.dart"'}),"import 'package:cloud_firestore/cloud_firestore.dart';\nimport 'package:firebase_auth/firebase_auth.dart';\nimport 'package:flutter/material.dart';\nimport 'package:flutter_firebase_firestore_crud2a/models/post.dart';\nimport 'package:flutter_firebase_firestore_crud2a/pages/posts_show_page.dart';\nimport 'package:provider/provider.dart';\n\nclass MyPostsPage extends StatelessWidget {\n  @override\n  Widget build(BuildContext context) {\n    final user = Provider.of<FirebaseUser>(context);\n\n    return Scaffold(\n      appBar: AppBar(\n        title: Text('My Posts'),\n      ),\n      body: StreamBuilder<QuerySnapshot>(\n        stream: Firestore.instance\n                  .collection(\"users\")\n                  .document(user.uid)\n                  .collection(\"posts\")\n                  .orderBy('createdAt', descending: true)\n                  .snapshots(),\n        builder: (BuildContext context, AsyncSnapshot<QuerySnapshot> snapshot) {\n          if (snapshot.hasError) return Text('Error: ${snapshot.error}');\n          switch (snapshot.connectionState) {\n            case ConnectionState.waiting:\n              return Text('Loading...');\n            default:\n              return ListView(\n                children: snapshot.data.documents.map((DocumentSnapshot document) {\n                  final post = Post.fromFirestore(document);\n\n                  return ListTile(\n                    title: Text(\n                      post.title,\n                      style: TextStyle(fontWeight: FontWeight.bold),\n                    ),\n                    subtitle: Text(post.content),\n                    onTap: () {\n                      Navigator.push(\n                        context,\n                        MaterialPageRoute(\n                          builder: (context) => PostsShowPage(post: post),\n                        ),\n                      );\n                    },\n                  );\n                }).toList(),\n              );\n          }\n        },\n      ),\n    );\n  }\n}\n")),Object(a.b)("p",null,"This code is almost same with ",Object(a.b)("inlineCode",{parentName:"p"},"lib/pages/home_page.dart")),Object(a.b)("p",null,"Note that stream is a little bit different."),Object(a.b)("pre",null,Object(a.b)("code",Object(r.a)({parentName:"pre"},{className:"language-dart",metastring:"{2}","{2}":!0}),'stream: Firestore.instance\n    .collection("users")\n    .document(user.uid)\n    .collection("posts")\n    .orderBy(\'createdAt\', descending: true)\n    .snapshots()\n')),Object(a.b)("h2",{id:"add-popupmenubutton"},"Add ",Object(a.b)("strong",{parentName:"h2"},"PopupMenuButton")),Object(a.b)("img",{src:"https://storage.googleapis.com/coderhackers-assets/flutter_firebase_firestore_crud2a/add-popup-menu-button.gif",height:"400"}),Object(a.b)("ul",null,Object(a.b)("li",{parentName:"ul"},Object(a.b)("a",Object(r.a)({parentName:"li"},{href:"https://api.flutter.dev/flutter/material/PopupMenuButton-class.html"}),"https://api.flutter.dev/flutter/material/PopupMenuButton-class.html")),Object(a.b)("li",{parentName:"ul"},Object(a.b)("a",Object(r.a)({parentName:"li"},{href:"https://flutter-widget.live/widgets/PopupMenuButton"}),"https://flutter-widget.live/widgets/PopupMenuButton"))),Object(a.b)("pre",null,Object(a.b)("code",Object(r.a)({parentName:"pre"},{className:"language-dart",metastring:'{7-30} title="lib/pages/my_posts_page.dart"',"{7-30}":!0,title:'"lib/pages/my_posts_page.dart"'}),'return ListTile(\n  title: Text(\n    post.title,\n    style: TextStyle(fontWeight: FontWeight.bold),\n  ),\n  subtitle: Text(post.content),\n  trailing: PopupMenuButton(\n    onSelected: (result) async {\n      final type = result["type"];\n      final post = result["value"];\n      switch (type) {\n        case \'edit\':\n          print(\'click edit\');\n          break;\n        case \'delete\':\n          print(\'click delete\');\n          break;\n      }\n    },\n    itemBuilder: (BuildContext context) => <PopupMenuEntry>[\n      PopupMenuItem(\n        value: {"type": "edit", "value": post},\n        child: Text(\'Edit\'),\n      ),\n      PopupMenuItem(\n        value: {"type": "delete", "value": post},\n        child: Text(\'Delete\'),\n      ),\n    ],\n  ),\n  onTap: () {\n    Navigator.push(\n      context,\n      MaterialPageRoute(\n        builder: (context) => PostsShowPage(post: post),\n      ),\n    );\n  },\n);\n')))}u.isMDXComponent=!0},211:function(e,t,n){"use strict";n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return m}));var r=n(0),a=n.n(r);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function p(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var u=a.a.createContext({}),c=function(e){var t=a.a.useContext(u),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},l=function(e){var t=c(e.components);return a.a.createElement(u.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return a.a.createElement(a.a.Fragment,{},t)}},b=a.a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,o=e.originalType,s=e.parentName,u=p(e,["components","mdxType","originalType","parentName"]),l=c(n),b=r,m=l["".concat(s,".").concat(b)]||l[b]||d[b]||o;return n?a.a.createElement(m,i(i({ref:t},u),{},{components:n})):a.a.createElement(m,i({ref:t},u))}));function m(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=n.length,s=new Array(o);s[0]=b;var i={};for(var p in t)hasOwnProperty.call(t,p)&&(i[p]=t[p]);i.originalType=e,i.mdxType="string"==typeof e?e:r,s[1]=i;for(var u=2;u<o;u++)s[u]=n[u];return a.a.createElement.apply(null,s)}return a.a.createElement.apply(null,n)}b.displayName="MDXCreateElement"}}]);